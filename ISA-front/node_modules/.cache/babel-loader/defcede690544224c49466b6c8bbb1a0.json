{"ast":null,"code":"var _jsxFileName = \"E:\\\\aca\\\\isa\\\\nasa-isa\\\\ISA-projekat\\\\ISA-front\\\\src\\\\Components\\\\Pharmacies\\\\AbsenceForPhAdmin.js\";\nimport React, { Component } from \"react\";\nimport Axios from \"axios\";\nimport Header from '../Header';\nimport 'react-confirm-alert/src/react-confirm-alert.css'; // Import css\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_URL = \"http://localhost:8080\";\n\nclass AbsenceForPhAdmin extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      absences: [],\n      pharmacyId: '',\n      showReasonModal: false\n    };\n\n    this.onClickAcceptAbsence = id => {\n      let EntityIdDTO = {\n        id: id\n      };\n      Axios.put(BASE_URL + \"/api/absence/accept-absence\", EntityIdDTO, {\n        validateStatus: () => true,\n        headers: {\n          Authorization: GetAuthorisation()\n        }\n      }).then(res => {\n        if (res.status === 204) {\n          this.setState({\n            hiddenSuccessAlert: false,\n            hiddenFailAlert: true,\n            successHeader: \"Success\",\n            successMessage: \"You successfully approve absence\"\n          });\n          this.updateAbsences();\n        } else if (res.status === 400) {\n          this.setState({\n            hiddenSuccessAlert: true,\n            hiddenFailAlert: false,\n            failHeader: \"Unsuccess\",\n            failMessage: \"Currently not possible to approve absence\"\n          });\n        } else if (res.status === 401) {\n          this.setState({\n            unauthorizedRedirect: true\n          });\n        }\n\n        console.log(res.data);\n      }).catch(err => {});\n    };\n\n    this.onClickRejectAbsence = id => {\n      this.setState({\n        showReasonModal: true,\n        absenceToReject: id\n      });\n    };\n\n    this.updateAbsences = () => {\n      Axios.get(BASE_URL + \"/api/absence/get-absence-for-pharmacy?pharmacyId=\" + this.state.pharmacyId, {\n        headers: {\n          Authorization: GetAuthorisation()\n        }\n      }).then(res => {\n        this.setState({\n          absences: res.data\n        });\n        console.log(res.data);\n      }).catch(err => {\n        console.log(err);\n      });\n    };\n\n    this.handleCloseAbsenceModal = () => {\n      this.setState({\n        showReasonModal: false\n      });\n    };\n\n    this.handleRejectSuccessModalClose = () => {\n      this.setState({\n        showReasonModal: false,\n        hiddenSuccessAlert: false,\n        hiddenFailAlert: true,\n        successHeader: \"Success\",\n        successMessage: \"You successfully reject absence\"\n      });\n      this.updateAbsences();\n    };\n  }\n\n  componentDidMount() {\n    let pharmacyId = localStorage.getItem(\"keyPharmacyId\");\n    this.setState({\n      pharmacyId: pharmacyId\n    });\n    Axios.get(BASE_URL + \"/absence/getPharmacyAbsences/\" + pharmacyId, {\n      headers: {\n        Authorization: GetAuthorisation()\n      }\n    }).then(res => {\n      this.setState({\n        absences: res.data\n      });\n      console.log(res.data);\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(React.Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(TopBar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container\",\n        style: {\n          marginTop: \"10%\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n          className: \" text-center  mt-2 text-uppercase\",\n          children: \"Absences \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n          className: \"table mt-3\",\n          style: {\n            width: \"100%\"\n          },\n          children: /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: this.state.absences.map(absence => /*#__PURE__*/_jsxDEV(\"tr\", {\n              hidden: false,\n              id: absence.Id,\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                width: \"130em\",\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  className: \"img-fluid\",\n                  src: WorkTimeIcon,\n                  width: \"100em\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 129,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 128,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"b\", {\n                    children: \"For employe:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 132,\n                    columnNumber: 50\n                  }, this), \" \", absence.EntityDTO.forStaff]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 132,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"b\", {\n                    children: \"Date from:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 134,\n                    columnNumber: 50\n                  }, this), \" \", new Date(absence.EntityDTO.startDate).toDateString()]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 134,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"b\", {\n                    children: \"Date to:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 135,\n                    columnNumber: 50\n                  }, this), \" \", new Date(absence.EntityDTO.endDate).toDateString()]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 135,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 131,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    marginLeft: '25%'\n                  },\n                  className: \"mt-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                    style: ({\n                      height: '30px'\n                    }, {\n                      verticalAlign: 'center'\n                    }),\n                    className: \"btn btn-outline-secondary\",\n                    onClick: () => this.onClickAcceptAbsence(absence.Id),\n                    type: \"button\",\n                    children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                      className: \"icofont-subscribe mr-1\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 139,\n                      columnNumber: 212\n                    }, this), \"Accept\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 139,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 140,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    style: ({\n                      height: '30px'\n                    }, {\n                      verticalAlign: 'center'\n                    }, {\n                      marginTop: '2%'\n                    }),\n                    className: \"btn btn-outline-secondary\",\n                    onClick: () => this.onClickRejectAbsence(absence.Id),\n                    type: \"button\",\n                    children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                      className: \"icofont-subscribe mr-1\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 141,\n                      columnNumber: 229\n                    }, this), \"Reject\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 141,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 142,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 138,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 137,\n                columnNumber: 41\n              }, this)]\n            }, absence.Id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 127,\n              columnNumber: 37\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(AbsenceRejectReasonModal, {\n          show: this.state.showReasonModal,\n          onCloseModal: this.handleCloseAbsenceModal,\n          onCloseWithRejectSuccess: this.handleRejectSuccessModalClose,\n          absenceId: this.state.absenceToReject,\n          updateDrugs: this.updateDrugs,\n          header: \"Reject absence\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 9\n    }, this);\n  }\n\n}\n\nexport default AbsenceForPhAdmin;","map":{"version":3,"sources":["E:/aca/isa/nasa-isa/ISA-projekat/ISA-front/src/Components/Pharmacies/AbsenceForPhAdmin.js"],"names":["React","Component","Axios","Header","API_URL","AbsenceForPhAdmin","state","absences","pharmacyId","showReasonModal","onClickAcceptAbsence","id","EntityIdDTO","put","BASE_URL","validateStatus","headers","Authorization","GetAuthorisation","then","res","status","setState","hiddenSuccessAlert","hiddenFailAlert","successHeader","successMessage","updateAbsences","failHeader","failMessage","unauthorizedRedirect","console","log","data","catch","err","onClickRejectAbsence","absenceToReject","get","handleCloseAbsenceModal","handleRejectSuccessModalClose","componentDidMount","localStorage","getItem","render","marginTop","width","map","absence","Id","WorkTimeIcon","EntityDTO","forStaff","Date","startDate","toDateString","endDate","marginLeft","height","verticalAlign","updateDrugs"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AAGA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,OAAOC,MAAP,MAAmB,WAAnB;AACA,OAAO,iDAAP,C,CAA0D;;;AAE1D,MAAMC,OAAO,GAAG,uBAAhB;;AAEA,MAAMC,iBAAN,SAAgCJ,SAAhC,CAA0C;AAAA;AAAA;AAAA,SACzCK,KADyC,GACjC;AACDC,MAAAA,QAAQ,EAAE,EADT;AAEDC,MAAAA,UAAU,EAAC,EAFV;AAGDC,MAAAA,eAAe,EAAC;AAHf,KADiC;;AAAA,SAsBtCC,oBAtBsC,GAsBfC,EAAE,IAAI;AACzB,UAAIC,WAAW,GAAG;AACdD,QAAAA,EAAE,EAAEA;AADU,OAAlB;AAIAT,MAAAA,KAAK,CACAW,GADL,CACSC,QAAQ,GAAG,6BADpB,EACmDF,WADnD,EACgE;AACxDG,QAAAA,cAAc,EAAE,MAAM,IADkC;AAExDC,QAAAA,OAAO,EAAE;AAAEC,UAAAA,aAAa,EAAEC,gBAAgB;AAAjC;AAF+C,OADhE,EAIOC,IAJP,CAIaC,GAAD,IAAQ;AACZ,YAAIA,GAAG,CAACC,MAAJ,KAAe,GAAnB,EAAwB;AACpB,eAAKC,QAAL,CAAc;AACVC,YAAAA,kBAAkB,EAAE,KADV;AAEVC,YAAAA,eAAe,EAAC,IAFN;AAGVC,YAAAA,aAAa,EAAE,SAHL;AAIVC,YAAAA,cAAc,EAAE;AAJN,WAAd;AAMA,eAAKC,cAAL;AACH,SARD,MAQM,IAAGP,GAAG,CAACC,MAAJ,KAAa,GAAhB,EAAoB;AACtB,eAAKC,QAAL,CAAc;AACVC,YAAAA,kBAAkB,EAAE,IADV;AAEVC,YAAAA,eAAe,EAAE,KAFP;AAGVI,YAAAA,UAAU,EAAE,WAHF;AAIVC,YAAAA,WAAW,EAAE;AAJH,WAAd;AAMH,SAPK,MAOA,IAAGT,GAAG,CAACC,MAAJ,KAAa,GAAhB,EAAoB;AACtB,eAAKC,QAAL,CAAc;AACVQ,YAAAA,oBAAoB,EAAC;AADX,WAAd;AAGH;;AACDC,QAAAA,OAAO,CAACC,GAAR,CAAYZ,GAAG,CAACa,IAAhB;AACH,OA1BL,EA0BOC,KA1BP,CA0BcC,GAAD,IAAS,CACjB,CA3BL;AA4BH,KAvDqC;;AAAA,SAyDtCC,oBAzDsC,GAyDdzB,EAAD,IAAQ;AAC3B,WAAKW,QAAL,CAAc;AACVb,QAAAA,eAAe,EAAC,IADN;AAEV4B,QAAAA,eAAe,EAAC1B;AAFN,OAAd;AAIH,KA9DqC;;AAAA,SAkEtCgB,cAlEsC,GAkErB,MAAK;AAClBzB,MAAAA,KAAK,CACJoC,GADD,CACKxB,QAAQ,GAAG,mDAAX,GAAgE,KAAKR,KAAL,CAAWE,UADhF,EAC4F;AACjGQ,QAAAA,OAAO,EAAE;AAAEC,UAAAA,aAAa,EAAEC,gBAAgB;AAAjC;AADwF,OAD5F,EAGHC,IAHG,CAGGC,GAAD,IAAQ;AACN,aAAKE,QAAL,CAAc;AAACf,UAAAA,QAAQ,EAAGa,GAAG,CAACa;AAAhB,SAAd;AACAF,QAAAA,OAAO,CAACC,GAAR,CAAYZ,GAAG,CAACa,IAAhB;AACH,OAND,EAMGC,KANH,CAMUC,GAAD,IAAS;AAACJ,QAAAA,OAAO,CAACC,GAAR,CAAYG,GAAZ;AAAkB,OANrC;AAOH,KA1EqC;;AAAA,SA+EtCI,uBA/EsC,GA+EZ,MAAK;AAC3B,WAAKjB,QAAL,CAAc;AACVb,QAAAA,eAAe,EAAC;AADN,OAAd;AAGH,KAnFqC;;AAAA,SAqFtC+B,6BArFsC,GAqFN,MAAK;AACjC,WAAKlB,QAAL,CAAc;AACVb,QAAAA,eAAe,EAAC,KADN;AAEVc,QAAAA,kBAAkB,EAAE,KAFV;AAGVC,QAAAA,eAAe,EAAC,IAHN;AAIVC,QAAAA,aAAa,EAAE,SAJL;AAKVC,QAAAA,cAAc,EAAE;AALN,OAAd;AAOA,WAAKC,cAAL;AACH,KA9FqC;AAAA;;AAOtCc,EAAAA,iBAAiB,GAAG;AACtB,QAAIjC,UAAU,GAACkC,YAAY,CAACC,OAAb,CAAqB,eAArB,CAAf;AACA,SAAKrB,QAAL,CAAc;AACbd,MAAAA,UAAU,EAAEA;AADC,KAAd;AAIMN,IAAAA,KAAK,CACJoC,GADD,CACKxB,QAAQ,GAAG,+BAAX,GAA4CN,UADjD,EAC6D;AAClEQ,MAAAA,OAAO,EAAE;AAAEC,QAAAA,aAAa,EAAEC,gBAAgB;AAAjC;AADyD,KAD7D,EAGHC,IAHG,CAGGC,GAAD,IAAQ;AACN,WAAKE,QAAL,CAAc;AAACf,QAAAA,QAAQ,EAAGa,GAAG,CAACa;AAAhB,OAAd;AACAF,MAAAA,OAAO,CAACC,GAAR,CAAYZ,GAAG,CAACa,IAAhB;AACH,KAND,EAMGC,KANH,CAMUC,GAAD,IAAS;AAACJ,MAAAA,OAAO,CAACC,GAAR,CAAYG,GAAZ;AAAkB,KANrC;AAOH;;AA4EDS,EAAAA,MAAM,GAAG;AAGX,wBACM,QAAC,KAAD,CAAO,QAAP;AAAA,8BACI;AAAA;AAAA;AAAA;AAAA,cADJ,eAKY,QAAC,MAAD;AAAA;AAAA;AAAA;AAAA,cALZ,eAMY,QAAC,MAAD;AAAA;AAAA;AAAA;AAAA,cANZ,eASY;AAAK,QAAA,SAAS,EAAC,WAAf;AAA2B,QAAA,KAAK,EAAE;AAAEC,UAAAA,SAAS,EAAE;AAAb,SAAlC;AAAA,gCAEd;AAAI,UAAA,SAAS,EAAC,mCAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAFc,eAII;AAAO,UAAA,SAAS,EAAC,YAAjB;AAA8B,UAAA,KAAK,EAAE;AAACC,YAAAA,KAAK,EAAC;AAAP,WAArC;AAAA,iCACI;AAAA,sBACK,KAAKxC,KAAL,CAAWC,QAAX,CAAoBwC,GAApB,CAAwBC,OAAO,iBAC5B;AAAI,cAAA,MAAM,EAAE,KAAZ;AAAmB,cAAA,EAAE,EAAEA,OAAO,CAACC,EAA/B;AAAA,sCACI;AAAI,gBAAA,KAAK,EAAC,OAAV;AAAA,uCACI;AAAK,kBAAA,SAAS,EAAC,WAAf;AAA2B,kBAAA,GAAG,EAAEC,YAAhC;AAA8C,kBAAA,KAAK,EAAC;AAApD;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,sBADJ,eAII;AAAA,wCACI;AAAA,0CAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAL,OAA0BF,OAAO,CAACG,SAAR,CAAkBC,QAA5C;AAAA;AAAA;AAAA;AAAA;AAAA,wBADJ,eAGI;AAAA,0CAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAL,OAAwB,IAAIC,IAAJ,CAASL,OAAO,CAACG,SAAR,CAAkBG,SAA3B,EAAsCC,YAAtC,EAAxB;AAAA;AAAA;AAAA;AAAA;AAAA,wBAHJ,eAII;AAAA,0CAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAL,OAAsB,IAAIF,IAAJ,CAASL,OAAO,CAACG,SAAR,CAAkBK,OAA3B,EAAoCD,YAApC,EAAtB;AAAA;AAAA;AAAA;AAAA;AAAA,wBAJJ;AAAA;AAAA;AAAA;AAAA;AAAA,sBAJJ,eAUI;AAAA,uCACI;AAAM,kBAAA,KAAK,EAAE;AAACE,oBAAAA,UAAU,EAAC;AAAZ,mBAAb;AAAiC,kBAAA,SAAS,EAAC,MAA3C;AAAA,0CACI;AAAQ,oBAAA,KAAK,GAAE;AAACC,sBAAAA,MAAM,EAAC;AAAR,uBAAgB;AAACC,sBAAAA,aAAa,EAAC;AAAf,qBAAlB,CAAb;AAAyD,oBAAA,SAAS,EAAC,2BAAnE;AAA+F,oBAAA,OAAO,EAAE,MAAM,KAAKjD,oBAAL,CAA0BsC,OAAO,CAACC,EAAlC,CAA9G;AAAqJ,oBAAA,IAAI,EAAC,QAA1J;AAAA,4CAAmK;AAAG,sBAAA,SAAS,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA,4BAAnK;AAAA;AAAA;AAAA;AAAA;AAAA,0BADJ,eAEI;AAAA;AAAA;AAAA;AAAA,0BAFJ,eAGI;AAAQ,oBAAA,KAAK,GAAE;AAACS,sBAAAA,MAAM,EAAC;AAAR,uBAAgB;AAACC,sBAAAA,aAAa,EAAC;AAAf,qBAAhB,EAAyC;AAACd,sBAAAA,SAAS,EAAC;AAAX,qBAA3C,CAAb;AAA0E,oBAAA,SAAS,EAAC,2BAApF;AAAgH,oBAAA,OAAO,EAAE,MAAM,KAAKT,oBAAL,CAA0BY,OAAO,CAACC,EAAlC,CAA/H;AAAsK,oBAAA,IAAI,EAAC,QAA3K;AAAA,4CAAoL;AAAG,sBAAA,SAAS,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA,4BAApL;AAAA;AAAA;AAAA;AAAA;AAAA,0BAHJ,eAII;AAAA;AAAA;AAAA;AAAA,0BAJJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,sBAVJ;AAAA,eAAwCD,OAAO,CAACC,EAAhD;AAAA;AAAA;AAAA;AAAA,oBADH;AADL;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBAJJ;AAAA;AAAA;AAAA;AAAA;AAAA,cATZ,eAuCY;AAAA,+BACI,QAAC,wBAAD;AACI,UAAA,IAAI,EAAE,KAAK3C,KAAL,CAAWG,eADrB;AAEI,UAAA,YAAY,EAAE,KAAK8B,uBAFvB;AAGI,UAAA,wBAAwB,EAAE,KAAKC,6BAHnC;AAII,UAAA,SAAS,EAAE,KAAKlC,KAAL,CAAW+B,eAJ1B;AAKI,UAAA,WAAW,EAAE,KAAKuB,WALtB;AAMX,UAAA,MAAM,EAAC;AANI;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,cAvCZ;AAAA;AAAA;AAAA;AAAA;AAAA,YADN;AAoDA;;AAvJwC;;AA0J1C,eAAevD,iBAAf","sourcesContent":["import React, { Component } from \"react\";\r\n\r\n\r\nimport Axios from \"axios\";\r\n\r\nimport Header from '../Header';\r\nimport 'react-confirm-alert/src/react-confirm-alert.css'; // Import css\r\n\r\nconst API_URL = \"http://localhost:8080\";\r\n\r\nclass AbsenceForPhAdmin extends Component {\r\n\tstate = {\r\n        absences: [],\r\n        pharmacyId:'',\r\n        showReasonModal:false,\r\n    };\r\n\r\n    componentDidMount() {\r\n\t\tlet pharmacyId=localStorage.getItem(\"keyPharmacyId\")\r\n\t\tthis.setState({\r\n\t\t\tpharmacyId: pharmacyId\r\n\t\t})\r\n\r\n        Axios\r\n        .get(BASE_URL + \"/absence/getPharmacyAbsences/\"+ pharmacyId, {\r\n\t\t\theaders: { Authorization: GetAuthorisation() },\r\n\t\t}).then((res) =>{\r\n            this.setState({absences : res.data});\r\n            console.log(res.data);\r\n        }).catch((err) => {console.log(err);});\r\n    }\r\n\r\n    onClickAcceptAbsence = id => {\r\n        let EntityIdDTO = {\r\n            id: id\r\n        };\r\n        \r\n        Axios\r\n            .put(BASE_URL + \"/api/absence/accept-absence\", EntityIdDTO, {\r\n                validateStatus: () => true,\r\n                headers: { Authorization: GetAuthorisation() },\r\n            }).then((res) =>{\r\n                if (res.status === 204) {\r\n                    this.setState({\r\n                        hiddenSuccessAlert: false,\r\n                        hiddenFailAlert:true,\r\n                        successHeader: \"Success\",\r\n                        successMessage: \"You successfully approve absence\"\r\n                    })\r\n                    this.updateAbsences();\r\n                }else if(res.status===400){\r\n                    this.setState({ \r\n                        hiddenSuccessAlert: true,\r\n                        hiddenFailAlert: false, \r\n                        failHeader: \"Unsuccess\", \r\n                        failMessage: \"Currently not possible to approve absence\"\r\n                    });\r\n                }else if(res.status===401){\r\n                    this.setState({ \r\n                        unauthorizedRedirect:true\r\n                    });\r\n                }\r\n                console.log(res.data);\r\n            }).catch((err) => {\r\n            });\r\n    }\r\n\r\n    onClickRejectAbsence = (id) => {\r\n        this.setState({\r\n            showReasonModal:true,\r\n            absenceToReject:id\r\n        })\r\n    }\r\n\r\n\r\n\r\n    updateAbsences = () =>{\r\n        Axios\r\n        .get(BASE_URL + \"/api/absence/get-absence-for-pharmacy?pharmacyId=\"+ this.state.pharmacyId, {\r\n\t\t\theaders: { Authorization: GetAuthorisation() },\r\n\t\t}).then((res) =>{\r\n            this.setState({absences : res.data});\r\n            console.log(res.data);\r\n        }).catch((err) => {console.log(err);});\r\n    }\r\n\r\n    \r\n   \r\n\r\n    handleCloseAbsenceModal = () =>{\r\n        this.setState({\r\n            showReasonModal:false\r\n        })\r\n    }\r\n\r\n    handleRejectSuccessModalClose = () =>{\r\n        this.setState({\r\n            showReasonModal:false,\r\n            hiddenSuccessAlert: false,\r\n            hiddenFailAlert:true,\r\n            successHeader: \"Success\",\r\n            successMessage: \"You successfully reject absence\"\r\n        })\r\n        this.updateAbsences();\r\n    }\r\n\r\n    render() {\r\n        \r\n\r\n\t\treturn (\r\n        <React.Fragment>\r\n            <div>\r\n\r\n            </div>\r\n\r\n                    <TopBar />\r\n                    <Header />\r\n\r\n        \r\n                    <div className=\"container\" style={{ marginTop: \"10%\" }} >\r\n                \r\n\t\t\t\t\t\t<h5 className=\" text-center  mt-2 text-uppercase\">Absences </h5>\r\n\r\n                        <table className=\"table mt-3\" style={{width:\"100%\"}}>\r\n                            <tbody>\r\n                                {this.state.absences.map(absence => \r\n                                    <tr hidden={false} id={absence.Id} key={absence.Id} >\r\n                                        <td width=\"130em\">\r\n                                            <img className=\"img-fluid\" src={WorkTimeIcon} width=\"100em\"/>\r\n                                        </td>\r\n                                        <td >\r\n                                            <div><b>For employe:</b> {absence.EntityDTO.forStaff}</div>\r\n\r\n                                            <div><b>Date from:</b> {new Date(absence.EntityDTO.startDate).toDateString()}</div>\r\n                                            <div><b>Date to:</b> {new Date(absence.EntityDTO.endDate).toDateString()}</div>\r\n                                        </td>\r\n                                        <td >\r\n                                            <div  style={{marginLeft:'25%'}} className=\"mt-2\">\r\n                                                <button style={{height:'30px'},{verticalAlign:'center'}} className=\"btn btn-outline-secondary\" onClick={() => this.onClickAcceptAbsence(absence.Id)} type=\"button\"><i className=\"icofont-subscribe mr-1\"></i>Accept</button>\r\n                                                <br></br>\r\n                                                <button style={{height:'30px'},{verticalAlign:'center'},{marginTop:'2%'}} className=\"btn btn-outline-secondary\" onClick={() => this.onClickRejectAbsence(absence.Id)} type=\"button\"><i className=\"icofont-subscribe mr-1\"></i>Reject</button>\r\n                                                <br></br>                                       \r\n                                             </div>\r\n                                        </td>\r\n                                    </tr>\r\n                                    )}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                    <div>\r\n                        <AbsenceRejectReasonModal\r\n                            show={this.state.showReasonModal}\r\n                            onCloseModal={this.handleCloseAbsenceModal}\r\n                            onCloseWithRejectSuccess={this.handleRejectSuccessModalClose}\r\n                            absenceId={this.state.absenceToReject}\r\n                            updateDrugs={this.updateDrugs}\r\n\t\t\t\t\t        header=\"Reject absence\"\r\n                         />\r\n                    </div>\r\n                </React.Fragment>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default AbsenceForPhAdmin"]},"metadata":{},"sourceType":"module"}