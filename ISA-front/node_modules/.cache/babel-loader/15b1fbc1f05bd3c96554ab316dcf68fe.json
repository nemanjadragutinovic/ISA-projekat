{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _api = require('../api');\n\nvar _api2 = _interopRequireDefault(_api);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction detectImagesLoaded(element) {\n  var images = Array.from(element.querySelectorAll('img') || []);\n\n  if (images.length === 0) {\n    return Promise.resolve();\n  }\n\n  return Promise.all(images.map(function (image) {\n    return new Promise(function (resolve) {\n      if (image.complete) {\n        resolve();\n        return;\n      }\n\n      image.onload = image.onerror = resolve;\n    });\n  }));\n}\n\nfunction createLayout(_ref) {\n  var domElement = _ref.domElement,\n      _ref$extendMethods = _ref.extendMethods,\n      extendMethods = _ref$extendMethods === undefined ? {} : _ref$extendMethods;\n\n  var LayoutClass = _api2.default.getAPI().templateLayoutFactory.createClass('<i></i>', Object.assign({\n    build: function build() {\n      LayoutClass.superclass.build.call(this);\n      this.options = this.getData().options;\n\n      this._setupContent(domElement);\n\n      this._updateSize();\n\n      detectImagesLoaded(this.getElement()).then(this._updateMarkerShape.bind(this));\n    },\n    getShape: function getShape() {\n      return new (_api2.default.getAPI().shape.Rectangle)(new (_api2.default.getAPI().geometry.pixel.Rectangle)([[0, 0], [this._size[0], this._size[1]]]));\n    },\n    _updateMarkerShape: function _updateMarkerShape() {\n      this._updateSize();\n\n      this.events.fire('shapechange');\n    },\n    _setupContent: function _setupContent(domElement) {\n      var element = this.getElement();\n      element.appendChild(domElement);\n    },\n    _updateSize: function _updateSize() {\n      this._size = this._getSize();\n    },\n    _getSize: function _getSize() {\n      var elementSize = [];\n\n      if (this.getElement()) {\n        var element = this.getElement().querySelector('.icon-content');\n\n        if (element) {\n          elementSize = [element.offsetWidth, element.offsetHeight];\n        }\n      }\n\n      return elementSize;\n    }\n  }, extendMethods));\n\n  return LayoutClass;\n}\n\nexports.default = {\n  createIconLayoutClass: function createIconLayoutClass(domElement) {\n    return createLayout({\n      domElement: domElement,\n      extendMethods: {\n        _updateSize: function _updateSize() {\n          var _this = this;\n\n          var geoObject = void 0;\n          var oldSize = this._size;\n          this._size = this._getSize(); // Update layout offset.\n\n          if (this._size.length) {\n            if (!oldSize || oldSize[0] !== this._size[0] || oldSize[1] !== this._size[1]) {\n              geoObject = this.getData().geoObject;\n\n              if (geoObject.getOverlaySync()) {\n                geoObject.options.set('iconOffset', [-this._size[0] / 2, -this._size[1]]);\n              } else {\n                geoObject.getOverlay().then(function () {\n                  geoObject.options.set('iconOffset', [-_this._size[0] / 2, -_this._size[1]]);\n                });\n              }\n            }\n          }\n        }\n      }\n    });\n  },\n  createBalloonLayoutClass: function createBalloonLayoutClass(domElement) {\n    return createLayout({\n      domElement: domElement\n    });\n  }\n};","map":{"version":3,"sources":["E:/aca/isa/nasa-isa/ISA-projekat/ISA-front/node_modules/yandex-map-react/lib/controllers/layouts.js"],"names":["Object","defineProperty","exports","value","_api","require","_api2","_interopRequireDefault","obj","__esModule","default","detectImagesLoaded","element","images","Array","from","querySelectorAll","length","Promise","resolve","all","map","image","complete","onload","onerror","createLayout","_ref","domElement","_ref$extendMethods","extendMethods","undefined","LayoutClass","getAPI","templateLayoutFactory","createClass","assign","build","superclass","call","options","getData","_setupContent","_updateSize","getElement","then","_updateMarkerShape","bind","getShape","shape","Rectangle","geometry","pixel","_size","events","fire","appendChild","_getSize","elementSize","querySelector","offsetWidth","offsetHeight","createIconLayoutClass","_this","geoObject","oldSize","getOverlaySync","set","getOverlay","createBalloonLayoutClass"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _api = require('../api');\n\nvar _api2 = _interopRequireDefault(_api);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction detectImagesLoaded(element) {\n    var images = Array.from(element.querySelectorAll('img') || []);\n\n    if (images.length === 0) {\n        return Promise.resolve();\n    }\n\n    return Promise.all(images.map(function (image) {\n        return new Promise(function (resolve) {\n            if (image.complete) {\n                resolve();\n                return;\n            }\n            image.onload = image.onerror = resolve;\n        });\n    }));\n}\n\nfunction createLayout(_ref) {\n    var domElement = _ref.domElement,\n        _ref$extendMethods = _ref.extendMethods,\n        extendMethods = _ref$extendMethods === undefined ? {} : _ref$extendMethods;\n\n    var LayoutClass = _api2.default.getAPI().templateLayoutFactory.createClass('<i></i>', Object.assign({\n        build: function build() {\n            LayoutClass.superclass.build.call(this);\n\n            this.options = this.getData().options;\n\n            this._setupContent(domElement);\n            this._updateSize();\n\n            detectImagesLoaded(this.getElement()).then(this._updateMarkerShape.bind(this));\n        },\n\n        getShape: function getShape() {\n            return new (_api2.default.getAPI().shape.Rectangle)(new (_api2.default.getAPI().geometry.pixel.Rectangle)([[0, 0], [this._size[0], this._size[1]]]));\n        },\n\n        _updateMarkerShape: function _updateMarkerShape() {\n            this._updateSize();\n            this.events.fire('shapechange');\n        },\n\n        _setupContent: function _setupContent(domElement) {\n            var element = this.getElement();\n            element.appendChild(domElement);\n        },\n\n        _updateSize: function _updateSize() {\n            this._size = this._getSize();\n        },\n\n        _getSize: function _getSize() {\n            var elementSize = [];\n\n            if (this.getElement()) {\n                var element = this.getElement().querySelector('.icon-content');\n\n                if (element) {\n                    elementSize = [element.offsetWidth, element.offsetHeight];\n                }\n            }\n\n            return elementSize;\n        }\n    }, extendMethods));\n\n    return LayoutClass;\n}\n\nexports.default = {\n    createIconLayoutClass: function createIconLayoutClass(domElement) {\n        return createLayout({\n            domElement: domElement,\n            extendMethods: {\n                _updateSize: function _updateSize() {\n                    var _this = this;\n\n                    var geoObject = void 0;\n                    var oldSize = this._size;\n\n                    this._size = this._getSize();\n\n                    // Update layout offset.\n                    if (this._size.length) {\n                        if (!oldSize || oldSize[0] !== this._size[0] || oldSize[1] !== this._size[1]) {\n                            geoObject = this.getData().geoObject;\n\n                            if (geoObject.getOverlaySync()) {\n                                geoObject.options.set('iconOffset', [-this._size[0] / 2, -this._size[1]]);\n                            } else {\n                                geoObject.getOverlay().then(function () {\n                                    geoObject.options.set('iconOffset', [-_this._size[0] / 2, -_this._size[1]]);\n                                });\n                            }\n                        }\n                    }\n                }\n            }\n        });\n    },\n\n    createBalloonLayoutClass: function createBalloonLayoutClass(domElement) {\n        return createLayout({ domElement: domElement });\n    }\n};"]},"metadata":{},"sourceType":"script"}