{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\PC\\\\Desktop\\\\faks\\\\4.god 1.semestar\\\\ISA\\\\ISA Projekat\\\\ISA-projekat\\\\ISA-front\\\\src\\\\Pages\\\\Appointment\\\\AppointmentReport.js\";\nimport React, { Component } from \"react\";\nimport Header from \"../../Components/Header\";\nimport TopBar from \"../../Components/TopBar\";\nimport Axios from \"axios\";\nimport DrugModal from \"../../Components/DrugModal\";\nimport AvailableDrugModal from \"../../Components/AvailableDrugModal\";\nimport { withRouter } from \"react-router\";\nimport GetAuthorisation from '../../Funciton/GetAuthorisation';\nimport { Redirect } from \"react-router-dom\";\nimport ModalDialog from \"../../Components/ModalDialog\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_URL = \"http://localhost:8080\";\n\nclass AppointmentReport extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      anamnesis: \"\",\n      diagnosis: \"\",\n      drugs: [],\n      openDrugsModal: false,\n      openDrugDetailsModal: false,\n      drug: {},\n      drugId: \"\",\n      name: \"\",\n      manufacturer: \"\",\n      quantity: \"\",\n      openModalSuccess: false,\n      appointment: {},\n      id: \"\",\n      patientId: \"\",\n      redirect: false,\n      redirectUrl: '',\n      drugsPatientIsNotAllergicTo: [],\n      alternativeDrugs: [],\n      openAlternativeDrugsModal: false\n    };\n\n    this.handleModalSuccessClose = () => {\n      this.setState({\n        openModalSuccess: false,\n        redirectUrl: \"/patient-profile/\" + this.state.patientId,\n        redirect: true\n      });\n    };\n\n    this.fetchDrugsPatientIsNotAllergicTo = () => {\n      Axios.get(API_URL + \"/drug/not-allergic/\" + this.state.patientId, {\n        validateStatus: () => true,\n        headers: {\n          Authorization: GetAuthorisation()\n        }\n      }).then(res => {\n        this.setState({\n          drugsPatientIsNotAllergicTo: res.data\n        });\n        console.log(res.data);\n      }).catch(err => {\n        console.log(err);\n      });\n    };\n\n    this.handleAnamnesisChange = event => {\n      this.setState({\n        anamnesis: event.target.value\n      });\n    };\n\n    this.handleDiagnosisChange = event => {\n      this.setState({\n        diagnosis: event.target.value\n      });\n    };\n\n    this.handleDrugsModalClose = () => {\n      this.setState({\n        openDrugsModal: false\n      });\n    };\n\n    this.handleDrugsModalOpen = () => {\n      this.setState({\n        openDrugsModal: true\n      });\n    };\n\n    this.handleDrugDetailsModalClose = () => {\n      this.setState({\n        openDrugDetailsModal: false\n      });\n    };\n\n    this.handleDrugDetailsModalOpen = () => {\n      this.setState({\n        openDrugDetailsModal: true\n      });\n    };\n\n    this.handleAlternativeDrugsModalClose = () => {\n      this.setState({\n        openAlternativeDrugsModal: false\n      });\n    };\n\n    this.handleAlternativeDrugsModalOpen = () => {\n      this.setState({\n        openAlternativeDrugsModal: true\n      });\n    };\n\n    this.handleSubmit = event => {\n      let therapy = \"drug : number of days\" + \"\\n\";\n      this.state.drugs.forEach((value, index) => {\n        therapy += value.drug.EntityDTO.manufacturer.EntityDTO.name + \" \" + value.drug.EntityDTO.name + \" : \" + value.amount + \"\\n\";\n      });\n      console.log(therapy);\n      Axios.post(API_URL + \"/appointment/report\", {\n        anamnesis: this.state.anamnesis,\n        diagnosis: this.state.diagnosis,\n        therapy: therapy,\n        appointmentId: this.state.id\n      }, {\n        headers: {\n          Authorization: GetAuthorisation()\n        }\n      }).then(res => {\n        this.setState({\n          openModalSuccess: true\n        });\n      }).catch(err => {\n        console.log(err);\n      });\n      Axios.put(API_URL + \"/appointment/finish\", {\n        id: this.state.id\n      }, {\n        headers: {\n          Authorization: GetAuthorisation()\n        }\n      }).catch(err => {\n        console.log(err);\n      });\n      this.state.drugs.forEach((value, index) => {\n        Axios.post(API_URL + \"/drug/staff/reserve\", {\n          patientId: this.state.patientId,\n          drugInstanceId: value.drug.Id,\n          amount: value.amount\n        }, {\n          headers: {\n            Authorization: GetAuthorisation()\n          }\n        }).catch(err => {\n          console.log(err);\n        });\n      });\n    };\n\n    this.handleDrugDetails = drug => {\n      console.log(drug);\n      this.setState({\n        drugId: drug.Id,\n        drug: drug,\n        name: drug.EntityDTO.drugInstanceName,\n        quantity: drug.EntityDTO.quantity,\n        manufacturer: drug.EntityDTO.manufacturer.EntityDTO.name\n      });\n      this.handleAlternativeDrugsModalClose();\n      this.handleDrugsModalClose();\n      this.handleDrugDetailsModalOpen();\n    };\n\n    this.handleAddDrug = drugAmount => {\n      console.log(this.state.drug);\n      this.handleDrugDetailsModalClose();\n      Axios.get(API_URL + \"/drug/available/\" + this.state.drug.Id + \"/\" + drugAmount, {\n        validateStatus: () => true,\n        headers: {\n          Authorization: GetAuthorisation()\n        }\n      }).then(res => {\n        if (res.status === 200) {\n          this.state.drugs.push({\n            drug: this.state.drug,\n            amount: drugAmount\n          });\n          this.state.drugsPatientIsNotAllergicTo = this.state.drugsPatientIsNotAllergicTo.filter(drug => this.state.drug.Id != drug.Id);\n          this.setState(this.state);\n        } else {\n          console.log(res.data);\n          this.setState({\n            alternativeDrugs: []\n          });\n          this.state.drug.EntityDTO.replacingDrugs.forEach(x => this.addAlternativeDrug(x));\n          this.setState(this.state);\n          console.log(this.state.alternativeDrugs);\n          this.handleAlternativeDrugsModalOpen();\n        }\n      }).catch(err => {\n        console.log(err);\n      });\n    };\n\n    this.addAlternativeDrug = x => {\n      let alternative = this.state.drugsPatientIsNotAllergicTo.filter(drug => x.Id == drug.Id);\n      alternative.forEach(x => this.state.alternativeDrugs.push(x));\n    };\n\n    this.handleRemoveTherapyDrug = (e, drug, index) => {\n      console.log(index);\n      this.state.drugs.splice(index, 1);\n      this.state.drugsPatientIsNotAllergicTo.push(drug);\n      this.setState(this.state);\n    };\n  }\n\n  componentDidMount() {\n    const id = this.props.match.params.id;\n    this.setState({\n      id: id\n    });\n    Axios.get(API_URL + \"/api/appointment/\" + id, {\n      validateStatus: () => true,\n      headers: {\n        Authorization: GetAuthorisation()\n      }\n    }).then(res => {\n      if (res.status === 401) {\n        this.setState({\n          redirect: true,\n          redirectUrl: \"/unauthorized\"\n        });\n      } else {\n        console.log(res.data);\n        this.setState({\n          appointment: res.data,\n          patientId: res.data.EntityDTO.patient.Id\n        });\n        this.fetchDrugsPatientIsNotAllergicTo();\n      }\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n\n  render() {\n    if (this.state.redirect) return /*#__PURE__*/_jsxDEV(Redirect, {\n      push: true,\n      to: this.state.redirectUrl\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 35\n    }, this);\n    return /*#__PURE__*/_jsxDEV(React.Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        hidden: this.props.hidden,\n        children: [/*#__PURE__*/_jsxDEV(TopBar, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 5\n        }, this), /*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 5\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"container\",\n          style: {\n            marginTop: \"10%\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \" text-center mb-0 mt-2 text-uppercase\",\n            children: \"Treatment report\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"form-group\",\n              children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                children: \"Anamnesis\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 215,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                class: \"form-control\",\n                value: this.state.anamnesis,\n                onChange: this.handleAnamnesisChange,\n                rows: \"5\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 216,\n                columnNumber: 29\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 214,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"form-group\",\n              children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                children: \"Diagnosis\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 219,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                class: \"form-control\",\n                value: this.state.diagnosis,\n                onChange: this.handleDiagnosisChange,\n                rows: \"3\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 220,\n                columnNumber: 29\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 218,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group text-left\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              style: {\n                background: \"#1977cc\"\n              },\n              onClick: this.handleDrugsModalOpen,\n              className: \"btn btn-primary btn-1x\",\n              type: \"button\",\n              children: \"Add therapy drug\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 224,\n              columnNumber: 10\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n            style: {\n              minHeight: \"50px\"\n            },\n            className: \"border border-secondary\",\n            children: /*#__PURE__*/_jsxDEV(\"table\", {\n              className: \"table table-hover m-0\",\n              children: /*#__PURE__*/_jsxDEV(\"tbody\", {\n                children: this.state.drugs.map((drug, index) => /*#__PURE__*/_jsxDEV(\"tr\", {\n                  id: drug.Id,\n                  style: {\n                    cursor: \"pointer\"\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                    width: \"130em\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 244,\n                    columnNumber: 10\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"b\", {\n                        children: \"Name:\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 249,\n                        columnNumber: 12\n                      }, this), \" \", drug.drug.EntityDTO.drugInstanceName]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 248,\n                      columnNumber: 11\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"b\", {\n                        children: \"Manufacturer:\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 252,\n                        columnNumber: 12\n                      }, this), \" \", drug.drug.EntityDTO.manufacturer.EntityDTO.name]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 251,\n                      columnNumber: 11\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"b\", {\n                        children: \"Quantity:\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 256,\n                        columnNumber: 12\n                      }, this), \" \", drug.drug.EntityDTO.quantity, \" \", /*#__PURE__*/_jsxDEV(\"b\", {\n                        children: \"mg\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 256,\n                        columnNumber: 60\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 255,\n                      columnNumber: 11\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"b\", {\n                        children: \"Number of days:\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 259,\n                        columnNumber: 12\n                      }, this), \" \", drug.amount]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 258,\n                      columnNumber: 11\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 247,\n                    columnNumber: 10\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: /*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: e => this.handleRemoveTherapyDrug(e, drug.drug, index),\n                      className: \"btn btn-danger btn-1x\",\n                      type: \"button\",\n                      style: {\n                        float: \"right\"\n                      },\n                      children: \"Remove therapy drug\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 263,\n                      columnNumber: 10\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 262,\n                    columnNumber: 10\n                  }, this)]\n                }, drug.Id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 239,\n                  columnNumber: 9\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 237,\n                columnNumber: 7\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 234,\n              columnNumber: 6\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group text-center\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              style: {\n                background: \"#1977cc\",\n                marginTop: \"50px\"\n              },\n              onClick: this.handleSubmit,\n              className: \"btn btn-primary btn-lg\",\n              type: \"button\",\n              children: \"Submit treatment report\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 278,\n              columnNumber: 10\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 277,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 5\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 4\n      }, this), /*#__PURE__*/_jsxDEV(DrugModal, {\n        show: this.state.openDrugsModal,\n        onCloseModal: this.handleDrugsModalClose,\n        header: \"Pick drug you want to prescribe as therapy\",\n        subheader: \"You can only choose between drugs patient is not allergic to\",\n        handleDrugDetails: this.handleDrugDetails,\n        drugsPatientIsNotAllergicTo: this.state.drugsPatientIsNotAllergicTo\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(AvailableDrugModal, {\n        show: this.state.openAlternativeDrugsModal,\n        onCloseModal: this.handleAlternativeDrugsModalClose,\n        header: \"No selected drug in stock, here are some alternatives\",\n        subheader: \"You can choose between alternative drugs\",\n        handleDrugDetails: this.handleDrugDetails,\n        alternativeDrugs: this.state.alternativeDrugs\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 297,\n        columnNumber: 4\n      }, this), /*#__PURE__*/_jsxDEV(ModalDialog, {\n        show: this.state.openModalSuccess,\n        onCloseModal: this.handleModalSuccessClose,\n        header: \"Successfully submitted treatment report for patient\",\n        text: \"You can schedule another appointment for this patient.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 4\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default _c = withRouter(AppointmentReport);\n\nvar _c;\n\n$RefreshReg$(_c, \"%default%\");","map":{"version":3,"sources":["C:/Users/PC/Desktop/faks/4.god 1.semestar/ISA/ISA Projekat/ISA-projekat/ISA-front/src/Pages/Appointment/AppointmentReport.js"],"names":["React","Component","Header","TopBar","Axios","DrugModal","AvailableDrugModal","withRouter","GetAuthorisation","Redirect","ModalDialog","API_URL","AppointmentReport","state","anamnesis","diagnosis","drugs","openDrugsModal","openDrugDetailsModal","drug","drugId","name","manufacturer","quantity","openModalSuccess","appointment","id","patientId","redirect","redirectUrl","drugsPatientIsNotAllergicTo","alternativeDrugs","openAlternativeDrugsModal","handleModalSuccessClose","setState","fetchDrugsPatientIsNotAllergicTo","get","validateStatus","headers","Authorization","then","res","data","console","log","catch","err","handleAnamnesisChange","event","target","value","handleDiagnosisChange","handleDrugsModalClose","handleDrugsModalOpen","handleDrugDetailsModalClose","handleDrugDetailsModalOpen","handleAlternativeDrugsModalClose","handleAlternativeDrugsModalOpen","handleSubmit","therapy","forEach","index","EntityDTO","amount","post","appointmentId","put","drugInstanceId","Id","handleDrugDetails","drugInstanceName","handleAddDrug","drugAmount","status","push","filter","replacingDrugs","x","addAlternativeDrug","alternative","handleRemoveTherapyDrug","e","splice","componentDidMount","props","match","params","patient","render","hidden","marginTop","background","minHeight","map","cursor","float"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport Header from \"../../Components/Header\";\r\nimport TopBar from \"../../Components/TopBar\";\r\nimport Axios from \"axios\";\r\nimport DrugModal from \"../../Components/DrugModal\";\r\nimport AvailableDrugModal from \"../../Components/AvailableDrugModal\";\r\nimport { withRouter } from \"react-router\";\r\nimport GetAuthorisation from '../../Funciton/GetAuthorisation';\r\nimport { Redirect } from \"react-router-dom\";\r\nimport ModalDialog from \"../../Components/ModalDialog\";\r\nconst API_URL=\"http://localhost:8080\";\r\n\r\nclass AppointmentReport extends Component {\r\n\tstate = {\r\n        anamnesis: \"\",\r\n        diagnosis: \"\",\r\n        drugs: [],\r\n        openDrugsModal: false,\r\n        openDrugDetailsModal: false,\r\n\t\tdrug: {},\r\n\t\tdrugId: \"\",\r\n        name: \"\",\r\n        manufacturer: \"\",\r\n\t\tquantity: \"\",\r\n\t\topenModalSuccess: false,\r\n\t\tappointment: {},\r\n\t\tid: \"\",\r\n\t\tpatientId: \"\",\r\n\t\tredirect: false,\r\n\t\tredirectUrl: '',\r\n\t\tdrugsPatientIsNotAllergicTo: [],\r\n\t\talternativeDrugs: [],\r\n\t\topenAlternativeDrugsModal: false,\r\n\t};\r\n\r\n\thandleModalSuccessClose = () => {\r\n\t\tthis.setState({ openModalSuccess: false, redirectUrl: \"/patient-profile/\" + this.state.patientId, redirect: true });\r\n\t};\r\n\r\n\tfetchDrugsPatientIsNotAllergicTo = () => {\r\n\t\tAxios.get(API_URL + \"/drug/not-allergic/\" + this.state.patientId, {validateStatus: () => true, headers: { Authorization: GetAuthorisation() }})\r\n        .then((res) => {\r\n            this.setState({ drugsPatientIsNotAllergicTo: res.data });\r\n            console.log(res.data);\r\n        })\r\n        .catch((err) => {\r\n            console.log(err);\r\n        });\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tconst id = this.props.match.params.id;\r\n\t\tthis.setState({\r\n\t\t\tid:id\r\n\t\t});\r\n\r\n\t\tAxios.get(API_URL + \"/api/appointment/\" + id, \r\n\t\t\t{validateStatus: () => true, headers: { Authorization: GetAuthorisation() }}\r\n\t\t)\r\n\t\t\t.then((res) => {\r\n\t\t\t\tif (res.status === 401) {\r\n\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\tredirect: true,\r\n\t\t\t\t\t\tredirectUrl: \"/unauthorized\"\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.log(res.data)\r\n\t\t\t\t\tthis.setState({ appointment: res.data, patientId: res.data.EntityDTO.patient.Id});\r\n\t\t\t\t\tthis.fetchDrugsPatientIsNotAllergicTo();\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.catch((err) => {\r\n\t\t\t\tconsole.log(err);\r\n\t\t\t})\r\n\t}\r\n\r\n    handleAnamnesisChange = (event) => {\r\n\t\tthis.setState({ anamnesis: event.target.value });\r\n\t};\r\n\r\n\thandleDiagnosisChange = (event) => {\r\n\t\tthis.setState({ diagnosis: event.target.value });\r\n    };\r\n\r\n    handleDrugsModalClose = () => {\r\n\t\tthis.setState({ openDrugsModal: false });\r\n    };\r\n\r\n    handleDrugsModalOpen = () => {\r\n\r\n\t\tthis.setState({ openDrugsModal: true });\r\n    };\r\n    \r\n    handleDrugDetailsModalClose = () => {\r\n\t\tthis.setState({ openDrugDetailsModal: false });\r\n    };\r\n\r\n    handleDrugDetailsModalOpen = () => {\r\n\t\tthis.setState({ openDrugDetailsModal: true });\r\n\t};\r\n\r\n\thandleAlternativeDrugsModalClose = () => {\r\n\t\tthis.setState({ openAlternativeDrugsModal: false });\r\n    };\r\n\r\n    handleAlternativeDrugsModalOpen = () => {\r\n\r\n\t\tthis.setState({ openAlternativeDrugsModal: true });\r\n    };\r\n    \r\n    handleSubmit = (event) => {\r\n\t\tlet therapy = \"drug : number of days\" + \"\\n\";\r\n\t\tthis.state.drugs.forEach((value, index) => {\r\n\t\t\ttherapy += value.drug.EntityDTO.manufacturer.EntityDTO.name + \" \" + value.drug.EntityDTO.name + \" : \" + value.amount + \"\\n\";\r\n\t\t});\r\n\t\tconsole.log(therapy);\r\n\r\n\t\tAxios.post(API_URL + \"/appointment/report\",\r\n\t\t\t{anamnesis: this.state.anamnesis, diagnosis: this.state.diagnosis, therapy: therapy, appointmentId: this.state.id},\r\n\t\t\t{headers: { Authorization: GetAuthorisation() }}\r\n\t\t)\r\n\t\t\t.then((res) => {\r\n\t\t\t\tthis.setState({ openModalSuccess: true});\r\n\t\t\t})\r\n\t\t\t.catch((err) => {\r\n\t\t\t\tconsole.log(err);\r\n\t\t\t})\r\n\r\n\t\tAxios.put(API_URL + \"/appointment/finish\",\r\n\t\t\t{id: this.state.id},\r\n\t\t\t{headers: { Authorization: GetAuthorisation() }}\r\n\t\t)\r\n\t\t.catch((err) => {\r\n\t\t\tconsole.log(err);\r\n\t\t})\r\n\t\t\r\n\t\tthis.state.drugs.forEach((value, index) => {\r\n\t\t\tAxios.post(API_URL + \"/drug/staff/reserve\",\r\n\t\t\t\t{ patientId: this.state.patientId, drugInstanceId: value.drug.Id, amount: value.amount},\r\n\t\t\t\t{headers: { Authorization: GetAuthorisation() }}\r\n\t\t\t)\r\n\t\t\t.catch((err) => {\r\n\t\t\t\tconsole.log(err);\r\n\t\t\t})\r\n\r\n\t\t});\r\n    };\r\n\r\n    handleDrugDetails = (drug) => {\r\n        console.log(drug); \r\n        this.setState({\r\n\t\t\tdrugId: drug.Id,\r\n            drug: drug,\r\n            name: drug.EntityDTO.drugInstanceName,\r\n            quantity: drug.EntityDTO.quantity,\r\n            manufacturer: drug.EntityDTO.manufacturer.EntityDTO.name\r\n\t\t});\r\n\t\tthis.handleAlternativeDrugsModalClose(); \r\n        this.handleDrugsModalClose(); \r\n        this.handleDrugDetailsModalOpen();\r\n    };\r\n\r\n    handleAddDrug = (drugAmount) => {\r\n        console.log(this.state.drug); \r\n\t\tthis.handleDrugDetailsModalClose();\r\n\t\tAxios.get(API_URL + \"/drug/available/\" + this.state.drug.Id + \"/\" + drugAmount, \r\n\t\t\t{validateStatus: () => true, headers: { Authorization: GetAuthorisation() }}\r\n\t\t)\r\n\t\t\t.then((res) => {\r\n\t\t\t\tif (res.status === 200) {\r\n\t\t\t\t\tthis.state.drugs.push({drug: this.state.drug, amount: drugAmount});\r\n\t\t\t\t\tthis.state.drugsPatientIsNotAllergicTo = this.state.drugsPatientIsNotAllergicTo.filter(drug => this.state.drug.Id != drug.Id);\r\n\t\t\t\t\tthis.setState(this.state);\t\t\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.log(res.data);\r\n\t\t\t\t\tthis.setState({alternativeDrugs: []});\r\n\t\t\t\t\tthis.state.drug.EntityDTO.replacingDrugs.forEach( x => this.addAlternativeDrug(x));\r\n\t\t\t\t\tthis.setState(this.state);\r\n\t\t\t\t\tconsole.log(this.state.alternativeDrugs);\r\n\t\t\t\t\tthis.handleAlternativeDrugsModalOpen();\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.catch((err) => {\r\n\t\t\t\tconsole.log(err);\r\n\t\t\t})\r\n\t};\r\n\r\n\taddAlternativeDrug = (x) => {\r\n\t\tlet alternative = this.state.drugsPatientIsNotAllergicTo.filter(drug => x.Id == drug.Id);\r\n\t\talternative.forEach(x => this.state.alternativeDrugs.push(x));\r\n\t};\r\n\t\r\n\thandleRemoveTherapyDrug = (e, drug, index) => {\r\n\t\tconsole.log(index)\r\n\t\tthis.state.drugs.splice(index, 1);\r\n\t\tthis.state.drugsPatientIsNotAllergicTo.push(drug)\r\n\t\tthis.setState(this.state);\r\n\t};\r\n\r\n\trender() {\r\n\r\n\t\tif (this.state.redirect) return <Redirect push to={this.state.redirectUrl} />;\r\n\r\n\t\treturn (\r\n            <React.Fragment>\r\n\t\t\t<div hidden={this.props.hidden}>\r\n\t\t\t\t<TopBar />\r\n\t\t\t\t<Header />\r\n\r\n\t\t\t\t<div className=\"container\" style={{ marginTop: \"10%\" }}>\r\n\t\t\t\t\t<h4 className=\" text-center mb-0 mt-2 text-uppercase\">Treatment report</h4>\r\n\r\n                    <form>\r\n                        <div class=\"form-group\">\r\n                            <h5>Anamnesis</h5>\r\n                            <textarea class=\"form-control\" value={this.state.anamnesis} onChange={this.handleAnamnesisChange} rows=\"5\"></textarea>\t\t\r\n                        </div>\r\n                        <div class=\"form-group\">\r\n                            <h5>Diagnosis</h5>\r\n                            <textarea class=\"form-control\" value={this.state.diagnosis} onChange={this.handleDiagnosisChange} rows=\"3\"></textarea>\r\n                        </div>\r\n                    </form>\r\n\t\t\t\t\t<div className=\"form-group text-left\">\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tstyle={{ background: \"#1977cc\" }}\r\n\t\t\t\t\t\t\t\t\t\tonClick={this.handleDrugsModalOpen}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"btn btn-primary btn-1x\"\r\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\tAdd therapy drug\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t    </div>\r\n\t\t\t\t\t<form style={{minHeight: \"50px\"}} className=\"border border-secondary\">\r\n\t\t\t\t\t<table\r\n\t\t\t\t\t\tclassName=\"table table-hover m-0\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t{this.state.drugs.map((drug, index) => (\r\n\t\t\t\t\t\t\t\t<tr\r\n\t\t\t\t\t\t\t\t\tid={drug.Id}\r\n\t\t\t\t\t\t\t\t\tkey={drug.Id}\r\n\t\t\t\t\t\t\t\t\tstyle={{ cursor: \"pointer\" }}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<td width=\"130em\">\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t<b>Name:</b> {drug.drug.EntityDTO.drugInstanceName}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t<b>Manufacturer:</b>{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\t{drug.drug.EntityDTO.manufacturer.EntityDTO.name}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t<b>Quantity:</b> {drug.drug.EntityDTO.quantity} <b>mg</b>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t<b>Number of days:</b> {drug.amount}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tonClick={(e) => this.handleRemoveTherapyDrug(e, drug.drug, index)}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"btn btn-danger btn-1x\"\r\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\tstyle={{float: \"right\"}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\tRemove therapy drug\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t\t</form>\r\n                    <div className=\"form-group text-center\">\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tstyle={{ background: \"#1977cc\", marginTop: \"50px\" }}\r\n\t\t\t\t\t\t\t\t\t\tonClick={this.handleSubmit}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"btn btn-primary btn-lg\"\r\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\tSubmit treatment report\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t    </div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n            <DrugModal           \r\n            show={this.state.openDrugsModal}\r\n            onCloseModal={this.handleDrugsModalClose}\r\n            header=\"Pick drug you want to prescribe as therapy\"\r\n            subheader=\"You can only choose between drugs patient is not allergic to\"\r\n\t\t\thandleDrugDetails={this.handleDrugDetails}\r\n\t\t\tdrugsPatientIsNotAllergicTo={this.state.drugsPatientIsNotAllergicTo}\r\n            />\r\n\t\t\t<AvailableDrugModal            \r\n            show={this.state.openAlternativeDrugsModal}\r\n            onCloseModal={this.handleAlternativeDrugsModalClose}\r\n            header=\"No selected drug in stock, here are some alternatives\"\r\n            subheader=\"You can choose between alternative drugs\"\r\n\t\t\thandleDrugDetails={this.handleDrugDetails}\r\n\t\t\talternativeDrugs={this.state.alternativeDrugs}\r\n            />\r\n            \r\n\t\t\t<ModalDialog\r\n\t\t\t\t\tshow={this.state.openModalSuccess}\r\n\t\t\t\t\tonCloseModal={this.handleModalSuccessClose}\r\n\t\t\t\t\theader=\"Successfully submitted treatment report for patient\"\r\n\t\t\t\t\ttext=\"You can schedule another appointment for this patient.\"\r\n\t\t\t\t/>\r\n            </React.Fragment>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withRouter(AppointmentReport);\r\n"]},"metadata":{},"sourceType":"module"}